import base64
exec(base64.b64decode("aW1wb3J0IHRpbWUKaW1wb3J0IHRocmVhZGluZwpmcm9tIHB5bnB1dC5tb3VzZSBpbXBvcnQgQnV0dG9uLCBDb250cm9sbGVyCmZyb20gcHlucHV0LmtleWJvYXJkIGltcG9ydCBMaXN0ZW5lciwgS2V5Q29kZQppbXBvcnQgY3R5cGVzCmltcG9ydCBwc3V0aWwKaW1wb3J0IG9zCgpkZWYgY2xlYXJDb25zb2xlKCk6CiAgICBjb21tYW5kID0gJ2NsZWFyJwogICAgaWYgb3MubmFtZSBpbiAoJ250JywgJ2RvcycpOgogICAgICAgIGNvbW1hbmQgPSAnY2xzJwogICAgb3Muc3lzdGVtKGNvbW1hbmQpCgpjbGVhckNvbnNvbGUoKQoKcHJpbnQoIiIiCiBfX19fXyAgICAgICAgICAgICAgICB8IHwgICAgICAgICAgX19fX18gXyBfICAgICBfCnwgICAgIHxfX18gXyBfIF9fXyBfX198X3wgICBfX18gICB8ICAgICB8IHxffF9fX3wgfF8gX19fIF9fXwp8IHwgfCB8IC4gfCB8IHxfIC18IC1ffCAgICB8XyAtfCAgfCAgIC0tfCB8IHwgIF98ICdffCAtX3wgIF98CnxffF98X3xfX198X19ffF9fX3xfX198ICAgIHxfX198ICB8X19fX198X3xffF9fX3xffF98X19ffF98CgpieSBNb3VzZV9FdmVudCBUZzpAbW91c2V2ZW50L0Bkb2dnb2J5cGFzcwoKIiIiKQoKY3R5cGVzLndpbmRsbC5rZXJuZWwzMi5TZXRDb25zb2xlVGl0bGVXKCIiKQpkZWxheT0wLjA0CmJ1dHRvbiA9IEJ1dHRvbi5sZWZ0CnN0YXJ0X3N0b3Bfa2V5ID0gS2V5Q29kZShjaGFyPWlucHV0KCIgVG9nZ2xlIGtleSAtPiAgIikpCmV4aXRfa2V5ID0gS2V5Q29kZShjaGFyPScnKQoKY2xhc3MgQ2xpY2tNb3VzZSh0aHJlYWRpbmcuVGhyZWFkKToKCiAgICBkZWYgX19pbml0X18oc2VsZiwgZGVsYXksIGJ1dHRvbik6CiAgICAgICAgc3VwZXIoQ2xpY2tNb3VzZSwgc2VsZikuX19pbml0X18oKQogICAgICAgIHNlbGYuZGVsYXkgPSBkZWxheQogICAgICAgIHNlbGYuYnV0dG9uID0gYnV0dG9uCiAgICAgICAgc2VsZi5ydW5uaW5nID0gRmFsc2UKICAgICAgICBzZWxmLnByb2dyYW1fcnVubmluZyA9IFRydWUKCiAgICBkZWYgc3RhcnRfY2xpY2tpbmcoc2VsZik6CiAgICAgICAgc2VsZi5ydW5uaW5nID0gVHJ1ZQoKICAgIGRlZiBzdG9wX2NsaWNraW5nKHNlbGYpOgogICAgICAgIHNlbGYucnVubmluZyA9IEZhbHNlCgogICAgZGVmIGV4aXQoc2VsZik6CiAgICAgICAgc2VsZi5zdG9wX2NsaWNraW5nKCkKICAgICAgICBzZWxmLnByb2dyYW1fcnVubmluZyA9IEZhbHNlCgogICAgZGVmIHJ1bihzZWxmKToKICAgICAgICB3aGlsZSBzZWxmLnByb2dyYW1fcnVubmluZzoKICAgICAgICAgICAgd2hpbGUgc2VsZi5ydW5uaW5nOgogICAgICAgICAgICAgICAgbW91c2UuY2xpY2soc2VsZi5idXR0b24pCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKHNlbGYuZGVsYXkpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMC4xKQoKCm1vdXNlID0gQ29udHJvbGxlcigpCmNsaWNrX3RocmVhZCA9IENsaWNrTW91c2UoZGVsYXksIGJ1dHRvbikKY2xpY2tfdGhyZWFkLnN0YXJ0KCkKCgpkZWYgb25fcHJlc3Moa2V5KToKICAgIGlmIGtleSA9PSBzdGFydF9zdG9wX2tleToKICAgICAgICBpZiBjbGlja190aHJlYWQucnVubmluZzoKICAgICAgICAgICAgY2xpY2tfdGhyZWFkLnN0b3BfY2xpY2tpbmcoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNsaWNrX3RocmVhZC5zdGFydF9jbGlja2luZygpCiAgICBlbGlmIGtleSA9PSBleGl0X2tleToKICAgICAgICBjbGlja190aHJlYWQuZXhpdCgpCiAgICAgICAgbGlzdGVuZXIuc3RvcCgpCgoKd2l0aCBMaXN0ZW5lcihvbl9wcmVzcz1vbl9wcmVzcykgYXMgbGlzdGVuZXI6CiAgICBsaXN0ZW5lci5qb2luKCk="))
